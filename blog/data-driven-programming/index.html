<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <style>
      :root {
        --accent-color: #05a081;
        --accent-color-light: #82d0c0;
      }
    </style>

    <meta name="theme-color" content="#05a081" />

    
      <link rel="icon" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;bb8e06f1bd83412a00.jpg" />
      <link rel="apple-touch-icon" sizes="48x48" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;bb8e06f1bd83412a00.jpg" />
      <link rel="apple-touch-icon" sizes="72x72" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;919926a10d297a1500.jpg" />
      <link rel="apple-touch-icon" sizes="96x96" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;6c2aa64354c1ad0e00.jpg" />
      <link rel="apple-touch-icon" sizes="144x144" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;f15f82763548a03000.jpg" />
      <link rel="apple-touch-icon" sizes="192x192" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;60ba6917360f159900.jpg" />
      <link rel="apple-touch-icon" sizes="256x256" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;be09d2da8b7096cc00.jpg" />
      <link rel="apple-touch-icon" sizes="384x384" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;165598e81aa1737500.jpg" />
      <link rel="apple-touch-icon" sizes="512x512" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;ca26ad195d4a364c00.jpg" />
    

    

    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary">

    

    

    
      
        <meta name="description" content="About, opinions and rants" />
        <meta name="twitter:description" content="About, opinions and rants">
      
    

    
      <meta name="twitter:title" content="On data-driven programming">
    

    
      <link rel="prerender" href="&#x2F;tags&#x2F;" />
    
      <link rel="prerender" href="&#x2F;blog&#x2F;" />
    

    <link rel="prefetch" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;d8f0e5c553a5794d00.jpg" />

    <title>
      
        
          On data-driven programming
        
      
    </title>

    
    
      <link rel="stylesheet" href="https://denisidoro.github.io/main.css">
    
    

<link rel="prerender" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;blog&#x2F;golang-repl&#x2F;">





<link rel="prerender" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;tags&#x2F;dev&#x2F;">

<link rel="prerender" href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;tags&#x2F;architecture&#x2F;">


<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://google.com/article"
      },
      "headline": "On data-driven programming",
      "image": [],
      "datePublished": "2020-09-02T00:00:00+00:00",
      "dateModified": "2020-09-02T00:00:00+00:00",
      "author": {
        "@type": "Person",
        "name": "Denis Isidoro"
      },
       "publisher": {
        "@type": "Organization",
        "name": "Denis Isidoro",
        "logo": {
          "@type": "ImageObject",
          "url": "https://denisidoro.github.io/profile_square.jpg"
        }
        
      }
      
    }
  </script>

<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        

        
        {
          
          "@type": "ListItem",
          "position": 1,
          "name": "Denis&#x27;s blog",
          "item": "https://denisidoro.github.io/"
        },
        
        {
          
          "@type": "ListItem",
          "position": 2,
          "name": "",
          "item": "https://denisidoro.github.io/blog/"
        },
        
        {
          "@type": "ListItem",
          "position": 3,
          "name": "On data-driven programming",
          "item": "https://denisidoro.github.io/blog/data-driven-programming/"
        }
      ]
    }
  </script>

  </head>
  <body>
    
      <header>
        <a class="profile-icon" href="/">
          <img src="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;processed_images&#x2F;d8f0e5c553a5794d00.jpg" alt="profile picture">
        </a>
        <nav>
          
            <a href="&#x2F;tags&#x2F;">Tags</a>
          
            <a href="&#x2F;blog&#x2F;">Blog</a>
          
        </nav>
      </header>
    
    <main>
    
<div class="post-title">
  <h1>On data-driven programming</h1>
  <small>
    September 02, 2020
    
    -
    <span class="tags">
      
      <a href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;tags&#x2F;dev&#x2F;">dev</a>
      
      <a href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;tags&#x2F;architecture&#x2F;">architecture</a>
      
    </span>
    
  </small>
</div>

<div>
  <figure>
    <img alt="Image for post" class="t u v gh aj" src="https://miro.medium.com/max/11014/0*43gbACYn_imJxYko" srcSet=" https://miro.medium.com/max/552/0*43gbACYn_imJxYko 276w, https://miro.medium.com/max/1104/0*43gbACYn_imJxYko 552w,
    https://miro.medium.com/max/1280/0*43gbACYn_imJxYko 640w, https://miro.medium.com/max/1400/0*43gbACYn_imJxYko 700w" sizes="700px" />
    <figcaption>Photo by
        <a href="https://unsplash.com/@aaronburden?utm_source=medium&utm_medium=referral">aaronburden</a>
        on¬†<a href="https://unsplash.com?utm_source=medium&utm_medium=referral">Unsplash</a> </figcaption>
</figure>
<p>If there‚Äôs one thing that <a href="https://en.wikipedia.org/wiki/Functional_programming">functional programming</a> has taught me is <a href="https://www.youtube.com/watch?v=-6BsiVyC1kM">the importance of values</a>.</p>
<p>Say we‚Äôre part of a startup‚Äôs founding team and are responsible for designing and building the core of its backend services. At its core, our job is to extract, transform and load values.</p>
<p>In general, the backend services must:</p>
<ul>
<li>receive values from the mobile app. e.g., a JSON payload in a REST endpoint</li>
<li>perform pure logic over values. e.g., apply <em>f(balance, purchase)</em> ‚Üí <em>new_balance</em></li>
<li>persist values in the database</li>
<li>and so on</li>
</ul>
<p>Everything else is overhead. <a href="https://www.w3schools.com/Java/java_encapsulation.asp">Getters and setters</a>, <a href="https://springframework.guru/gang-of-four-design-patterns/">Gang of Four patterns</a> and whatnot. Sure, these abstractions may allow you to scale code or team sizes. But they are overhead, still. They‚Äôre neither inherently part of our startup‚Äôs business model nor the reason the CEO decided to hire us.</p>
<p>I guess that this philosophy behind values as first-class citizens led to the <a href="https://en.wikipedia.org/wiki/Code_as_data">code as data</a> movement. Or <a href="https://en.wikipedia.org/wiki/Data-driven_programming">data-driven programming</a>. Think of DSLs and configuration files. If we want to change our app‚Äôs behavior, there‚Äôs no need to launch IntellijJ and dive into the code: we can fiddle with some JSON-like file using a notepad app. The code parses it and acts accordingly. Profit.</p>
<p>The benefits of such approach are undeniable, but they introduce new problems. The main ones, that I‚Äôm gonna cover in this post, are:</p>
<ul>
<li>entry barrier</li>
<li>no type-safety</li>
</ul>
<p>Let‚Äôs take a <a href="https://kubernetes.io/">Kubernetes</a> config as an example:</p>
<figure>
    <div >
    <script src="https:&#x2F;&#x2F;gist.github.com&#x2F;denisidoro&#x2F;10a79e0d5b5591a5da733f07bcd25233.js"></script>
</div>
    <figcaption>
    Is this code correct? Is there a typo? Should <code>containers</code> be a direct child of <code>spec</code> or <code>selector</code>? I know that <code>ports</code> has a <code>containerPort</code> field, but does it have any other one? If so, is it a string or a number?
</figcaption>
</figure>
<p>The <em>entry barrier</em> is the time we need to take to understand this syntax. It‚Äôs a new language, in some sense. It‚Äôs good, old YAML but there are rules we need to understand prior to reading or writing such pieces of text.</p>
<p>By <em>no type-safety</em> I mean all the goodies we lose that we otherwise would have in an IDE for a strongly typed language. Autocomplete, Intellisense and references to previously declared values.</p>
<p>For Kubernetes <a href="https://dockerlabs.collabnix.com/kubernetes/kubetools/">I bet there are</a> 3761 tools to make your life easier. But what about the DSLs we create?</p>
<p>To illustrate, let‚Äôs suppose our job is to create a DSL/config file for a <a href="https://medium.com/movile-tech/backend-driven-development-ios-d1c726f2913b">backend-driven UI</a> framework. i.e., we want to develop a system that allows front-end applications with screens and flows to be built based on backend responses. <a href="https://www.youtube.com/watch?v=vuCfKjOwZdU">Spotify does that</a>, by the way.</p>
<p>With this system, we theoretically only need one person to know the inner machinery of this code. But if a new intern wants to build a new screen, how will she know what to write in our DSL, in the first place?</p>
<h3 id="creating-an-editor-ui">Creating an editor¬†UI</h3>
<p>This is in my opinion the best approach. We could have a web editor with drag-and-drop elements, drop-downs and even a live preview window that shows us how the final result would be.</p>
<p>Discoverability is addressed by these UI elements that pop in front of us. Correctness is guaranteed by the UI itself‚Ää‚Äî‚Ääby preventing us from clicking on stuff that would result into an invalid file.</p>
<p>But this has some cons:</p>
<ul>
<li>it‚Äôs expensive to write‚Ää‚Äî‚Ääin terms of time, at least</li>
<li>it requires a full-stack team</li>
<li>it doesn‚Äôt solve the problem with code review‚Ää‚Äî‚Ääin case the UI spits a file such as the Kubernetes one, the code review in general is limited to <em>LGTM</em> or üôà, as in <em>I trust that you used the UI correctly and I trust that the UI is correct</em>.</li>
</ul>
<h3 id="making-use-of-our-ides">Making use of our¬†IDEs</h3>
<p>What if we wrote a plugin to VSCode, for example, that somehow helps other developers write our DSLs? But wait, we‚Äôre already using a popular format such as JSON or YAML. We could instead write a plugin that helps users write JSONs that follows some convention.</p>
<p>But there are millions of other developers out there. I bet someone has already thought about this and took the time to do exactly what we want. I‚Äôm lazy and our job in the startup is to persist values in the database and whatnot. I, for one, don‚Äôt want to focus efforts into this.</p>
<p>It turns out a solution does exist out there. The first page for the Google search <em>typed YAML</em> led me to <a href="https://github.com/crdoconnor/strictyaml">strictyaml</a>, which led me to <a href="https://json-schema.org/">JSON Schema</a>.</p>
<p>By using a battle-tested solution we get everything for free plus support for all major IDEs.</p>
<p>There are a lot of articles on the Internet about the benefits and capabilities of JSON Schema, so I won‚Äôt bother you with details. I‚Äôll simply demonstrate it with a GIF:</p>
<figure>
    <img alt="Image for post" class="medium-image"
        src="https://miro.medium.com/max/2160/1*Em1xMQgnAbMLMU9-jnAHAg.gif"
        srcSet="https://miro.medium.com/max/552/1*Em1xMQgnAbMLMU9-jnAHAg.gif 276w, https://miro.medium.com/max/1104/1*Em1xMQgnAbMLMU9-jnAHAg.gif 552w, https://miro.medium.com/max/1280/1*Em1xMQgnAbMLMU9-jnAHAg.gif 640w, https://miro.medium.com/max/1400/1*Em1xMQgnAbMLMU9-jnAHAg.gif 700w"
        sizes="700px" />
    <figcaption>The intern has just joined the company, but she already knows that someone, at some point in time, wrote a <code>billing_address</code> widget.</figcaption>
</figure>
<p>The schema used in this demo was extracted from <a href="https://rjsf-team.github.io/react-jsonschema-form/">react-jsonschema-form</a>.</p>
<p>I know that having a popup window when we type sounds like a small benefit but, if you stop to think about it, the intern didn‚Äôt even have to leave the file buffer! She didn‚Äôt need to browse through the code implementation, or read documents‚Ää‚Äî‚Ääthat are likely outdated or incomplete‚Ää‚Äî‚Ääor contact the people that contributed to the DSL.</p>
<p><a href="https://github.com/redhat-developer/vscode-yaml">There are ways</a> to extend this to YAML as well.</p>
<p>Oh, one suggestion: don‚Äôt write your JSON Schema <em>and</em> your code structs/classes by hand. Let one generate the other so that there‚Äôs a single source of truth.</p>
<h3 id="using-data-as-code-as-data">Using data as code (as¬†data)</h3>
<p>The cool thing about having a DSL inside a JSON file is that in general it is parseable at runtime: we don‚Äôt need to deploy a new server instance and stop the previous one. We can <code>curl -d &quot;@config.json&quot; -XPOST localhost:3000/apply</code> to update the app's behavior.</p>
<p>But if we don‚Äôt need such dynamism‚Ää‚Äî‚Ääif e.g. in order to update this config file we need to open a PR in the same repository as the code, which leads to a new image build‚Ää‚Äî‚Ääthen why not stay inside the code realm?</p>
<p>We‚Äôll need to refactor packages a little bit so that, by convention, a given set of files will be considered as data, in contrast to implementation detail code. It seems like a small price to pay, though.</p>
<p>In <a href="https://kotlinlang.org/">Kotlin</a> it would be <a href="https://medium.com/@fabiomirgo/kotlins-power-build-a-dsl-1fcf215b7bb0">straightforward</a> to come up with a file such as this one:</p>
<figure>
    <div >
    <script src="https:&#x2F;&#x2F;gist.github.com&#x2F;denisidoro&#x2F;5932b86b92fc520c57fd7e07730f59eb.js"></script>
</div>
    <figcaption>In IntelliJ, if you typed BillingAddress, an Intellisense window would show us all possible fields. If we forgot the street field, the editor would suggest us to add it.</figcaption>
</figure>
<p>This is exactly what <a href="https://github.com/Kotlin/anko">Anko</a> does in order to build Android UIs, for example.</p>
<p>Chances are that‚Ää‚Äî‚Ääassuming we wrote this in Kotlin‚Ää‚Äî‚Ääwe have other developers in the company already familiar with Kotlin, so they will feel at home with this syntax. No extra level of indirection introduced.</p>
<figcaption>‚èÆ This post first appeared on
    <a href="https://medium.com/@den.isidoro/on-data-driven-programming-925e450525e3" target="_blank">Medium</a></figcaption>

</div>

<hr class="footer-rule" />


<div class="footer-about">
  <p><em>Note: opinions expressed here are solely my own and do not necessarily express the views or experiences of my employer or past employers.</em></p>

</div>


<div class="related-container">

  
  <div class="link">
    Previous <br />
    <a href="https:&#x2F;&#x2F;denisidoro.github.io&#x2F;blog&#x2F;golang-repl&#x2F;">Quick prototyping with a Golang REPL</a>
  </div>
  

  

</div>


    </main>
  </body>
</html>
